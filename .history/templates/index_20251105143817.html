<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>HLS Stream Converter</title>
  <script>
    async function convert() {
      const src = document.getElementById("source").value.trim();
      if (!src) return alert("Masukkan URL terlebih dahulu!");
      const res = await fetch("/convert", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ source: src })
      });
      const data = await res.json();
      if (data.player_url) location.reload();
      else alert("Gagal convert: " + (data.error || "Unknown error"));
    }
  </script>
  <style>
    body { font-family: Arial; margin:40px; background:#fafafa; }
    input { width:70%; padding:8px; font-size:16px; }
    button { padding:8px 16px; font-size:16px; }
    table { width:100%; border-collapse:collapse; margin-top:20px; }
    th, td { border:1px solid #ccc; padding:8px; text-align:left; }
    th { background:#eee; }
  </style>
</head>
<body>
  <h2>ðŸŽ¥ HLS Stream Converter</h2>

  <input id="source" placeholder="Masukkan URL video streaming...">
  <button onclick="convert()">Convert</button>

  {% if streams %}
  <h3>Daftar Stream Aktif</h3>
  <table>
    <tr><th>ID</th><th>Sumber</th><th>Mulai</th><th>Link</th></tr>
    {% for s in streams %}
    <tr>
      <td>{{ s.id }}</td>
      <td>{{ s.source }}</td>
      <td>{{ s.started }}</td>
      <td><a href="{{ s.url }}" target="_blank">Tonton</a></td>
    </tr>
    {% endfor %}
  </table>
  {% else %}
  <p>Belum ada stream aktif.</p>
  {% endif %}
</body>
</html>
